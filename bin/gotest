#!/bin/bash

test() {
   date
   echo =================================================
   go test $GOTESTARGS
   echo =================================================
}

if [ "$1" = "test" ]; then
   shift
   test
else
   # this doesn't properly encode spaces, so args with interior
   # spaces will break.
   export GOTESTARGS="${*:-./...}"

   # reexec the current script; this works from minotaur and
   # ensures the reexec code is working on the first run
   "$0" test
   minotaur . -- "$0" test
fi

